---
import Layout from '../layouts/Layout.astro';
import Libros from '../assets/Libros.webp';
---

<Layout>
	<div class="pt-2.5">
		<header class="font-bold pt-1.5 bg-[#F5F3EB] rounded-full h-14 ml-31 max-w-5xl mx-auto">
			<h1 class="absolute text-[22px] ml-82 mt-[4.45px]">Reading is my superpower</h1>
			<img src={Libros.src} alt="Libros" class="absolute size-10 w-12 -mt-[-0.5px] ml-69" />
			<img src={Libros.src} alt="Libros" class="absolute size-10 w-12 -mt-[-0.5px] ml-178" />
			<a href="/login" class="absolute text-[16px] ml-230 mt-2.5">Login</a>
			<a href="/comic" class="absolute text-[16px] ml-6 mt-2.5">Comics</a>
		</header>
	</div>

	<article class="bg-[#F5F3EB] rounded-xl mt-4 max-w-5xl mx-auto p-6 shadow-lg">
		<h1 class="font-bold text-2xl mb-4 text-center text-gray-900">Welcome to event of Reading in Simon Bolivar High School!</h1>
		<p class="relative font-regular ml-1.5 text-[14px] leading-relaxed"> <br> ¡Hello dear students of the educational community of the Simón Bolívar Institution! <br><br> Today we present a very special event that celebrates creativity, imagination, and the love of reading. Students from 6th to 11th grade have participated in an inspiring project where they created their own original comics for an event titled "Reading is my superpower." Through this initiative, these young artists and storytellers were invited to express how reading empowers them, fuels their imagination, and transforms them into heroes of their own stories. <br><br> Each comic is a unique reflection of their perspective, combining colorful illustrations with powerful narratives that showcase the importance of reading in their lives. This project not only promotes literacy but also allows students to develop artistic skills, critical thinking, and a deeper connection to the stories they read and create.<br><br> Now, it's your turn to be part of this celebration. We invite you to explore the incredible comics these students have crafted and cast your vote for the one that resonates with you the most. Your participation helps encourage and recognize the talent and hard work of these young creators. Don't miss this chance to support their voices and celebrate the superpower of reading!</p>

		<button 
			onclick="document.getElementById('dialog').showModal()"
			class="mx-auto block mt-6 ml-70 bg-[#3A5A6B] text-white px-6 py-2 rounded-lg hover:bg-blue-800 transition-colors"
		>
			Show Voting Instructions
		</button>

		<button 
			onclick="document.getElementById('dialog2').showModal()"
			class="mx-auto block -mt-10 mr-80 bg-[#3A5A6B] text-white px-6 py-2 rounded-lg hover:bg-blue-800 transition-colors"
		>
			Vote now!
		</button>

		<dialog id="dialog" class="absolute rounded-xl max-w-5xl mx-auto p-6 backdrop:bg-black/40">
			<div class="bg-[#F5F3EB] p-6 rounded-xl">
				<form class="flex justify-end">
					<button class="text-gray-600 hover:text-gray-800">✕</button>
				</form>
				<h2 class="font-bold text-xl mb-4 text-center">Voting Instructions</h2>
				<p class="text-gray-700">
					1. Take your time to review each comic carefully.<br>
					2. Consider both the artwork and the story.<br>
					3. You can only vote once.<br>
					4. Select your favorite comic using the voting button.<br>
					5. Your vote will be final once submitted.
				</p>
			</div>
		</dialog>

		<dialog id="dialog2" class="absolute rounded-xl max-w-5xl mx-auto p-6 backdrop:bg-black/40">
	<div class="bg-[#F5F3EB] p-6 rounded-xl">
		<form method="dialog" class="flex justify-end">
			<button class="text-gray-600 hover:text-gray-800 mb-2">✕</button>
		</form>
		<h2 class="font-bold text-xl mb-4 text-center">Vote for the best comic now!</h2>
		<form method="post" action="/api/vote" id="voteForm">
			<div class="space-y-4">
				<div class="flex flex-col">
					<label for="Name" class="text-gray-700 font-medium mb-1">Name:</label>
					<input 
						type="text" 
						id="Name" 
						name="Name" 
						required 
						placeholder="Enter your name"
						class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#3A5A6B]"
					>
				</div>
				<div class="flex flex-col">
					<label for="Code" class="text-gray-700 font-medium mb-1">Instituional Code:</label>
					<input 
						type="text" 
						id="Code" 
						name="Code" 
						required 
						placeholder="Enter your Instituional Code"
						class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#3A5A6B]"
					>
				</div>
				<div class="flex flex-col">
					<label for="Grade" class="text-gray-700 font-medium mb-1">Grade:</label>
					<input 
						type="text" 
						id="Grade" 
						name="Grade" 
						required 
						placeholder="Enter your grade"
						class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#3A5A6B]"
					>
				</div>
				<div class="flex flex-col">
					<label for="Comic" class="text-gray-700 font-medium mb-1">Comic:</label>
					<select 
						id="Comic" 
						name="Comic" 
						required 
						class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#3A5A6B]"
					>
						<option value="" disabled selected>Select your favorite comic</option>
						<option value="comic1">The Reading Hero</option>
						<option value="comic2">Adventures in Bookland</option>
						<option value="comic3">Super Reader</option>
						<option value="comic4">The Power of Words</option>
						<option value="comic5">Library Warriors</option>
					</select>
				</div>
				<button type="submit" class="w-full bg-[#3A5A6B] text-white py-2 px-4 rounded-lg hover:bg-blue-800 transition-colors">
					Submit Vote
				</button>
				<p id="message" class="text-sm text-center mt-2"></p>
			</div>
		</form>

		<script>
	const form = document.getElementById('voteForm') as HTMLFormElement;
	const message = document.getElementById('message');

	if (!message) throw new Error('Message element not found');
	if (!form) throw new Error('Form element not found');

	form.addEventListener('submit', async (e) => {
		e.preventDefault();
		const data = Object.fromEntries(new FormData(form));
		console.log(data);

		try {
			const res = await fetch('/api/vote', {
				method: 'POST',
				headers: { 'Content-Type': 'application/json' },
				body: JSON.stringify(data)
			});

			const result = await res.json();
			message.textContent = result.message;
			message.className = 'text-green-600';
		} catch (err) {
			message.textContent = 'Error sending your vote.';
			message.className = 'text-red-600';
		}
	});
</script>

	</div>
</dialog>
</article>

	
</Layout>
